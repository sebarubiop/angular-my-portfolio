<div class="mapping-container">
  <div class="mapping-header">
    <h2>Interactive Map</h2>
    <p>Explore our interactive mapping application</p>
  </div>
  
  <div class="mapping-description">
    <div class="description-card">
      <h3>Micro-Frontend Integration</h3>
      <p>This page demonstrates micro-frontend architecture by integrating a React application within our Angular portfolio. The React mapping app is loaded using <strong>Module Federation</strong> (via &#64;angular-architects/module-federation) for seamless cross-framework integration.</p>
      <p class="implementation-details">This implementation showcases advanced frontend architecture patterns, allowing different frameworks to work together while maintaining performance and user experience. The React app runs independently but appears seamlessly integrated within the Angular application.</p>
      <div class="tech-stack">
        <span class="tech-badge">Angular 20</span>
        <span class="tech-badge">React</span>
        <span class="tech-badge">Module Federation</span>
        <span class="tech-badge">Micro-Frontends</span>
      </div>
    </div>
  </div>

  <!-- Module Federation Status -->
  <app-module-federation-status></app-module-federation-status>
  
  <div class="mapping-content">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <p>{{ loadingMessage }}</p>
    </div>
    
    <!-- Error State -->
    <div *ngIf="loadError" class="error-container">
      <div class="error-icon">‚ö†Ô∏è</div>
      <h4>Loading Error</h4>
      <p>{{ errorMessage }}</p>
      <div class="error-details">
        <p><strong>Attempt:</strong> {{ retryCount + 1 }}/{{ maxRetries + 1 }}</p>
        <p><strong>Method:</strong> {{ useModuleFederation ? 'Module Federation' : 'Iframe Fallback' }}</p>
      </div>
      <button (click)="retryCount = 0; loadReactMappingApp()" class="retry-button">Retry</button>
    </div>
    
    <!-- Module Federation Container -->
    <div #mappingContainer class="mapping-module-container" *ngIf="!isLoading && !loadError && useModuleFederation">
      <!-- React app will be rendered here via Module Federation -->
    </div>
    
    <!-- Fallback iframe approach -->
    <iframe 
      *ngIf="!isLoading && !loadError && !useModuleFederation"
      #mappingIframe
      [src]="mappingUrl | safe"
      class="mapping-iframe"
      frameborder="0"
      allowfullscreen>
    </iframe>
  </div>
  
  <!-- Module Federation Info -->
  <div class="module-federation-info" *ngIf="!isLoading && !loadError">
    <div class="info-card">
      <h4>Loading Method</h4>
      <p *ngIf="moduleFederationLoaded">‚úÖ <strong>Module Federation</strong> - React app loaded via Module Federation</p>
      <p *ngIf="!moduleFederationLoaded && !useModuleFederation">üîÑ <strong>Iframe Fallback</strong> - React app loaded via iframe</p>
      <p *ngIf="!moduleFederationLoaded && useModuleFederation">‚è≥ <strong>Loading...</strong> - Attempting Module Federation</p>
    </div>
  </div>
</div> 